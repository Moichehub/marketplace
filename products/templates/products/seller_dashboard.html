{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %}–ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü—è ‚Äî Tavero{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h1>–ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü—è</h1>
        <p>–ö–µ—Ä—É–π—Ç–µ –≤–∞—à–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üì¶</div>
            <div class="stat-content">
                <h3>{{ total_products }}</h3>
                <p>–í—Å—å–æ–≥–æ —Ç–æ–≤–∞—Ä—ñ–≤</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-content">
                <h3>{{ active_products }}</h3>
                <p>–ê–∫—Ç–∏–≤–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">‚è∏Ô∏è</div>
            <div class="stat-content">
                <h3>{{ inactive_products }}</h3>
                <p>–ù–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</p>
            </div>
        </div>
    </div>

    <!-- Actions -->
    <div class="dashboard-actions">
        <a href="{% url 'products:create' %}" class="btn btn-primary">‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–≤–∞—Ä</a>
    </div>

    <!-- Filters -->
    <form class="dashboard-filters" method="get">
        <input type="search" name="q" placeholder="–ü–æ—à—É–∫ —Ç–æ–≤–∞—Ä—ñ–≤..." value="{{ request.GET.q }}">
        <select name="category">
            <option value="">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
            {% for category in categories %}
                <option value="{{ category.slug }}" {% if request.GET.category == category.slug %}selected{% endif %}>
                    {{ category.name }}
                </option>
            {% endfor %}
        </select>
        <select name="status">
            <option value="">–í—Å—ñ —Å—Ç–∞—Ç—É—Å–∏</option>
            <option value="active" {% if request.GET.status == 'active' %}selected{% endif %}>–ê–∫—Ç–∏–≤–Ω—ñ</option>
            <option value="inactive" {% if request.GET.status == 'inactive' %}selected{% endif %}>–ù–µ–∞–∫—Ç–∏–≤–Ω—ñ</option>
        </select>
        <button type="submit" class="btn btn-secondary">üîç –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
        <a href="{% url 'products:seller_dashboard' %}" class="btn btn-secondary">üîÑ –°–∫–∏–Ω—É—Ç–∏</a>
    </form>

    <!-- Products Grid -->
    <div class="dashboard-products">
        {% if page_obj.object_list %}
            <div class="grid">
                {% for product in page_obj.object_list %}
                    <article class="card product-card">
                        {% if product.slug %}
                            <a href="{% url 'products:detail' slug=product.slug %}">
                                {% if product.image %}
                                    <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                {% else %}
                                    <div class="no-image">üì∑</div>
                                {% endif %}
                                <div class="card-content">
                                    <h3>{{ product.name }}</h3>
                                    <div class="muted">{{ product.category.name }}</div>
                                    <strong>{{ product.price }} ‚Ç¥</strong>
                                    <div class="product-meta">
                                        <span class="stock-info">–°–∫–ª–∞–¥: {{ product.stock }} —à—Ç.</span>
                                        <span class="status-badge {% if product.is_active %}status-active{% else %}status-inactive{% endif %}">
                                            {% if product.is_active %}‚úÖ –ê–∫—Ç–∏–≤–Ω–∏–π{% else %}‚è∏Ô∏è –ù–µ–∞–∫—Ç–∏–≤–Ω–∏–π{% endif %}
                                        </span>
                                    </div>
                                </div>
                            </a>
                            <div class="card-actions">
                                <a href="{% url 'products:update' slug=product.slug %}" class="btn-edit-small">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
                                <a href="{% url 'products:detail' slug=product.slug %}" class="btn-view-small">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</a>
                                <a href="{% url 'products:delete' slug=product.slug %}" class="btn-delete-small">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</a>
                            </div>
                        {% else %}
                            <div class="card-content">
                                <h3>{{ product.name }}</h3>
                                <div class="muted">{{ product.category.name }}</div>
                                <strong>{{ product.price }} ‚Ç¥</strong>
                                <div class="product-meta">
                                    <span class="stock-info">–°–∫–ª–∞–¥: {{ product.stock }} —à—Ç.</span>
                                    <span class="status-badge {% if product.is_active %}status-active{% else %}status-inactive{% endif %}">
                                        {% if product.is_active %}‚úÖ –ê–∫—Ç–∏–≤–Ω–∏–π{% else %}‚è∏Ô∏è –ù–µ–∞–∫—Ç–∏–≤–Ω–∏–π{% endif %}
                                    </span>
                                </div>
                                <div class="alert alert-warning">
                                    <p>‚ö†Ô∏è –¶–µ–π —Ç–æ–≤–∞—Ä –ø–æ—Ç—Ä–µ–±—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è slug. –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ç–æ–≤–∞—Ä.</p>
                                </div>
                            </div>
                            <div class="card-actions">
                                <span class="btn-edit-small disabled">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</span>
                                <span class="btn-view-small disabled">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</span>
                                <span class="btn-delete-small disabled">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</span>
                            </div>
                        {% endif %}
                    </article>
                {% endfor %}
            </div>

            <!-- Pagination -->
            <div class="pagination"
                 hx-get="{% url 'products:seller_dashboard' %}"
                 hx-target=".dashboard-products"
                 hx-select=".dashboard-products"
                 hx-swap="outerHTML">
                {% if page_obj.has_previous %}
                    <a href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.status %}status={{ request.GET.status }}&{% endif %}page={{ page_obj.previous_page_number }}">
                        ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—è
                    </a>
                {% endif %}
                <span>üìÑ –°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}</span>
                {% if page_obj.has_next %}
                    <a href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.status %}status={{ request.GET.status }}&{% endif %}page={{ page_obj.next_page_number }}">
                        –ù–∞—Å—Ç—É–ø–Ω–∞ ‚Üí
                    </a>
                {% endif %}
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">üì¶</div>
                <h3>–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤</h3>
                <p>–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤—ñ–π –ø–µ—Ä—à–∏–π —Ç–æ–≤–∞—Ä, —â–æ–± –ø–æ—á–∞—Ç–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç–∏ –Ω–∞ Tavero</p>
                <a href="{% url 'products:create' %}" class="btn btn-primary">‚ûï –î–æ–¥–∞—Ç–∏ –ø–µ—Ä—à–∏–π —Ç–æ–≤–∞—Ä</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
